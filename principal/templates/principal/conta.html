{% extends 'principal/base.html'%}
{% block titulo %}Principal {% endblock%}
{% load static %}
{% block conteudo %}

	{% if user != request.user %}
	<script language= "JavaScript">
			location.href="{%  url 'index' %}";
		</script>
	{% endif %}
	<br>
	{% if user == request.user %}
	<div class="row">	
		<div class="col-9">
			<a class="waves-effect waves-light btn modal-trigger blue" href="#modal1">Editar</a>
			{% if request.user.categoria == 'Prestador' %}<a class="waves-effect waves-light btn modal-trigger blue" href="{% url 'config' request.user.id %}">Configurações</a>{% endif %}
		</div>
	</div>
	<script type="text/javascript">
		document.addEventListener('DOMContentLoaded', function () {
			var elems = document.querySelectorAll('.modal');
			var instances = M.Modal.init(elems, options);
		});


		$(document).ready(function () {
			$('.modal').modal();
		});
	</script>
	<div id="modal1" class="modal modal-fixed-footer">
		<div class="modal-content">
			<h4>Editar Perfil</h4>
			<form method="POST" enctype="multipart/form-data" class="form-group">
				{% csrf_token %}
				<div class="row">
					<div class="col-4">
						<img src="{{user.imagem}}" class="rounded float-left" alt="..."
							style="max-height: 200px;max-width: 200px;">
						<span class="mdl-chip">
							<span class="mdl-chip__text">Trocar Imagem Perfil</span>
						</span>
						<input type="file" class="form-control" name="imagem">
					</div>
					<div class="col-4">
						<input type="text" class="validate" value="{{user.first_name}}" name="first_name">
						<label>Nome</label>
						<input type="text" class="validate" value="{{user.cpf_cnpj}}" name="cpf_cnpj">
						<label>CPF/CNPJ</label>
						<input type="text" class="validate" value="{{user.celular}}" name="celular">
						<label>Celular</label>

					</div>
					<div class="col-4">
						<input type="text" class="validate" value="{{user.last_name}}" name="last_name">
						<label>Sobrenome</label>
						<input type="date" class="validate" value="{{user.data_nasc}}" name="data_nasc">
						<label>Data de Nascimento</label>
						<input type="text" class="validate" value="{{user.telefone}}" name="date">
						<label>Telefone</label>
					</div>
				</div>
		</div>
		<div class="modal-footer">
			<input type="submit"
				class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent"
				value="Pronto">
			</form>
		</div>
	</div>
	{% endif %}
	<div class="row">
		<div class="col-sm-4">
			<div class="card hoverable">
				<div class="card-content">
					<div class="card-image">
						<img src="../media/{{user.imagem}}" class="circle" style="max-height: 200px; max-width: 220px;">
						</div>
					<span class="card-title">{{user.username}}</span>
					<div class="divider"></div>
					<div class="card-text">
						<b>Avaliação: </b> {{user.avaliacao}}
					</div>
				</div>
			</div>
		</div>
		<div class="col-sm-6">
			<div class="card hoverable">
				<div class="card-content">
					<span class="card-title">Sobre {{user.get_full_name}}</span>
					<div class="card-text">
						<b>Nome: </b>{{user.get_full_name}}<br>
						<b>Data de Nascimento: </b>{{user.nascimento}}<br>
						<b></b>
					</div>
				</div>
			</div>
		</div>

		
	</div>
	{% if request.user.categoria == 'Prestador' %}
	<div class="card hoverable">
			<div class="card-content">
				<span class="card-title"><h5>Comentários</h5></span>
				{% for comentario in comentarios %}
				<span class="mdl-chip">
						<span class="mdl-chip__text"><b>{{comentario.user_comentario.username}} </b>
							{{comentario.comentarios}}</span>
					</span>
				{% endfor %}
			</div>
			<div class="card-action grey lighten-2">
				{% endif %}
				{% if request.user.categoria == 'Consumidor' %}
				<button class="btn waves waves-light blue">Comentar</button>
				{% endif %}
				{% if request.user.categoria == 'Prestador' %}
			</div>
		</div>
		{% endif %}
{% endblock %}